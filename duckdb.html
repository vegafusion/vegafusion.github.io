<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta content="VegaFusion provides serverside acceleration of the Vega visualization grammar" lang="en" name="description" xml:lang="en" />
<meta content="VegaFusion" property="og:title" />
<meta content="VegaFusion provides serverside acceleration of the Vega visualization grammar" property="og:description" />
<meta content="en_US" property="og:locale" />
<meta content="https://vegafusion.io/" property="og:url" />
<meta content="https://vegafusion.io/_static/vegafusion_social.png" property="og:image" />
<meta content="&#64;vegafusion_io" property="twitter:site" />
<meta content="https://vegafusion.io/_static/vegafusion_social.png" property="twitter:image" />
<meta content="summary_large_image" property="twitter:card" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DuckDB &mdash; VegaFusion</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/site.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Polars" href="polars.html" />
    <link rel="prev" title="Integrations" href="integrations.html" />
 



</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            VegaFusion
              <img src="_static/VegaFusionLogo-Color.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="supported_environments.html">Supported Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="mime_renderer.html">Mime Renderer</a></li>
<li class="toctree-l1"><a class="reference internal" href="widget_renderer.html">Widget Renderer</a></li>
<li class="toctree-l1"><a class="reference internal" href="widget.html">VegaFusionWidget</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformed_data.html">Transformed Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="integrations.html">Integrations</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">DuckDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vega-transforms-with-duckdb">Vega transforms with DuckDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#access-duckdb-tables">Access DuckDB tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-options">Configuration options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fallback">Fallback</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verbose">Verbose</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="polars.html">Polars</a></li>
<li class="toctree-l2"><a class="reference internal" href="dataframe_interchange.html">DataFrame Interchange Protocol</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="save.html">Saving Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="low_level.html">Low Level APIs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_gallery.html">Example Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="background.html">Background and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_it_works.html">How VegaFusion Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="technology.html">Technology</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_the_name.html">About the Name</a></li>
<li class="toctree-l1"><a class="reference internal" href="related_projects.html">Related Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="license_overview.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing VegaFusion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Future</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">VegaFusion Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/hex-inc/vegafusion/">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/hex-inc/vegafusion/issues">Report an Issue</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/hex-inc/vegafusion/discussions">Start a Discussion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Blog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="blog.html">Posts</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VegaFusion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- Disable top breadcrumb bar -->
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
<section id="duckdb">
<h1>DuckDB<a class="headerlink" href="#duckdb" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://duckdb.org/">DuckDB</a> is an in-process SQL OLAP query engine and database that provides bindings for a wide variety of languages, including Python.  The VegaFusion Python library includes two forms of integration with DuckDB. First, it can use DuckDB in place of DataFusion to power Vega transforms over the pandas DataFrames that are referenced by Altair charts. Second, VegaFusion makes it possible to reference externally defined DuckDB tables and views in Altair charts.</p>
<p>To get started, install the <code class="docutils literal notranslate"><span class="pre">duckdb</span></code> package using pip…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="s2">&quot;duckdb&gt;=0.7&quot;</span>
</pre></div>
</div>
<p>or conda</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="s2">&quot;python-duckdb&gt;=0.7&quot;</span>
</pre></div>
</div>
<section id="vega-transforms-with-duckdb">
<h2>Vega transforms with DuckDB<a class="headerlink" href="#vega-transforms-with-duckdb" title="Permalink to this heading"></a></h2>
<p>VegaFusion can be configured to evaluate Vega transforms using the DuckDB Python library by calling <code class="docutils literal notranslate"><span class="pre">vegafusion.runtime.set_connection(&quot;duckdb&quot;)</span></code>.</p>
<p>Once the DuckDB connection is enabled, pandas DataFrames referenced by Altair charts are automatically registered with DuckDB and Vega transforms are translated into DuckDB SQL queries. Here is a full example, adapted from the <a class="reference external" href="https://altair-viz.github.io/gallery/histogram_heatmap.html">2D Histogram Heatmap</a> Altair gallery example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">vegafusion</span> <span class="k">as</span> <span class="nn">vf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="c1"># Configure DuckDB connection</span>
<span class="n">vf</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">set_connection</span><span class="p">(</span><span class="s2">&quot;duckdb&quot;</span><span class="p">)</span>

<span class="c1"># Enable Mime Renderer</span>
<span class="n">vf</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="c1"># Load 201k row version of the Vega movies dataset with pandas</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s2">&quot;https://vegafusion-datasets.s3.amazonaws.com/vega/movies_201k.parquet&quot;</span>
<span class="p">)</span>

<span class="c1"># Create an Altair chart from the pandas DataFrame as usual.</span>
<span class="c1"># Binning and aggregation will be evaluated against the DataFrame with DuckDB</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;IMDB_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">60</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;Rotten_Tomatoes_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;count():Q&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">chart</span>
</pre></div>
</div>
<p><img alt="2D Histogram Heatmap" src="https://user-images.githubusercontent.com/15064365/226609213-2eba5e0b-1377-47d1-9ca9-32dc8f43fb8c.png" /></p>
<p>The <a class="reference internal" href="#../../transformed_data.md"><span class="xref myst">transformed data</span></a> can be extracted as usual:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vf</span><span class="o">.</span><span class="n">transformed_data</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">row_limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-right"><p>0</p></th>
<th class="head text-right"><p>1</p></th>
<th class="head text-right"><p>2</p></th>
<th class="head text-right"><p>3</p></th>
<th class="head text-right"><p>4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>bin_maxbins_60_IMDB_Rating</p></td>
<td class="text-right"><p>3.4</p></td>
<td class="text-right"><p>5.8</p></td>
<td class="text-right"><p>7</p></td>
<td class="text-right"><p>7</p></td>
<td class="text-right"><p>7.4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>bin_maxbins_60_IMDB_Rating_end</p></td>
<td class="text-right"><p>3.6</p></td>
<td class="text-right"><p>6</p></td>
<td class="text-right"><p>7.2</p></td>
<td class="text-right"><p>7.2</p></td>
<td class="text-right"><p>7.6</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>bin_maxbins_40_Rotten_Tomatoes_Rating</p></td>
<td class="text-right"><p>60</p></td>
<td class="text-right"><p>25</p></td>
<td class="text-right"><p>85</p></td>
<td class="text-right"><p>80</p></td>
<td class="text-right"><p>80</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>bin_maxbins_40_Rotten_Tomatoes_Rating_end</p></td>
<td class="text-right"><p>65</p></td>
<td class="text-right"><p>30</p></td>
<td class="text-right"><p>90</p></td>
<td class="text-right"><p>85</p></td>
<td class="text-right"><p>85</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>__count</p></td>
<td class="text-right"><p>63</p></td>
<td class="text-right"><p>441</p></td>
<td class="text-right"><p>504</p></td>
<td class="text-right"><p>1260</p></td>
<td class="text-right"><p>1134</p></td>
</tr>
</tbody>
</table>
<p>The default DataFusion connection can be re-enabled by calling <code class="docutils literal notranslate"><span class="pre">vegafusion.runtime.set_connection(&quot;datafusion&quot;)</span></code></p>
</section>
<section id="access-duckdb-tables">
<h2>Access DuckDB tables<a class="headerlink" href="#access-duckdb-tables" title="Permalink to this heading"></a></h2>
<p>VegaFusion also supports integration with external DuckDB connections, making it possible to reference DuckDB tables and views from Altair charts.  To begin, import <code class="docutils literal notranslate"><span class="pre">duckdb</span></code> and create a new connection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">duckdb</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>Pass this DuckDB connection to <code class="docutils literal notranslate"><span class="pre">vegafusion.runtime.set_connection</span></code> (instead of the string <code class="docutils literal notranslate"><span class="pre">&quot;duckdb&quot;</span></code> as in the previous example).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vf</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">set_connection</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, use the DuckDB connection to create a table or view. Here, the DuckDB <code class="docutils literal notranslate"><span class="pre">read_parquet</span></code> method is used to load the 201k row movies dataset, and a DuckDB query is used to filter NULL values. The result of this query is registered as a table named <code class="docutils literal notranslate"><span class="pre">movies</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">relation</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s2">&quot;https://vegafusion-datasets.s3.amazonaws.com/vega/movies_201k.parquet&quot;</span>
<span class="p">)</span>

<span class="n">relation</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;tbl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM tbl </span>
<span class="s2">    WHERE Rotten_Tomatoes_Rating IS NOT NULL AND Imdb_Rating IS NOT NULL</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="s2">&quot;movies&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>DuckDB tables and views registered with <code class="docutils literal notranslate"><span class="pre">conn</span></code> may be referenced from Altair charts with a special URL syntax using <code class="docutils literal notranslate"><span class="pre">table://</span></code> as the prefix. To reference the DuckDB table named <code class="docutils literal notranslate"><span class="pre">movies</span></code>, the Altair chart should be passed the url string <code class="docutils literal notranslate"><span class="pre">&quot;table://movies&quot;</span></code>. Here is a full example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">duckdb</span>
<span class="kn">import</span> <span class="nn">vegafusion</span> <span class="k">as</span> <span class="nn">vf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="c1"># Create DuckDB connection</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># Pass DuckDB connection to VegaFusion&#39;s set_connection method</span>
<span class="n">vf</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">set_connection</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>

<span class="c1"># Enable Mime Renderer</span>
<span class="n">vf</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="c1"># Read parquet file using the DuckDB connection</span>
<span class="n">relation</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s2">&quot;https://vegafusion-datasets.s3.amazonaws.com/vega/movies_201k.parquet&quot;</span>
<span class="p">)</span>

<span class="c1"># Filter NULL values and register the result as a table named &quot;movies&quot;</span>
<span class="n">relation</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;tbl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM tbl </span>
<span class="s2">    WHERE Rotten_Tomatoes_Rating IS NOT NULL AND Imdb_Rating IS NOT NULL</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="s2">&quot;movies&quot;</span><span class="p">)</span>

<span class="c1"># Create an Altair chart that references the registered DuckDB table</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="s2">&quot;table://movies&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;IMDB_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">60</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;Rotten_Tomatoes_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;count():Q&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">chart</span>
</pre></div>
</div>
<p><img alt="2D Histogram Heatmap" src="https://user-images.githubusercontent.com/15064365/226609213-2eba5e0b-1377-47d1-9ca9-32dc8f43fb8c.png" /></p>
<p>Note, it’s important that the DuckDB connection that’s passed to <code class="docutils literal notranslate"><span class="pre">vegafusion.runtime.set_connection</span></code> is used to read the parquet file and register the table named <code class="docutils literal notranslate"><span class="pre">&quot;movies&quot;</span></code>.  The above example would not work if the parquet file were loaded with <code class="docutils literal notranslate"><span class="pre">duckdb.read_parquet</span></code> instead of <code class="docutils literal notranslate"><span class="pre">conn.read_parquet</span></code>.</p>
</section>
<section id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this heading"></a></h2>
<p>The VegaFusion DuckDB connection provides a few configuration options which are available using the <code class="docutils literal notranslate"><span class="pre">vegafusion.connection.duckdb.DuckDbConnection</span></code> class.</p>
<section id="fallback">
<h3>Fallback<a class="headerlink" href="#fallback" title="Permalink to this heading"></a></h3>
<p>By default, VegaFusion will fallback to the default DataFusion connection when Vega transform features are encountered that aren’t supported by the DuckDB connection. This behavior can be disabled by setting the <code class="docutils literal notranslate"><span class="pre">fallback</span></code> option to <code class="docutils literal notranslate"><span class="pre">False</span></code>. In this case, an error will be raised when unsupported features are required.</p>
</section>
<section id="verbose">
<h3>Verbose<a class="headerlink" href="#verbose" title="Permalink to this heading"></a></h3>
<p>When the <code class="docutils literal notranslate"><span class="pre">verbose</span></code> option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, VegaFusion will print out the DuckDB queries as they are evaluated.</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<p>Here is an example that sets <code class="docutils literal notranslate"><span class="pre">fallback</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">verbose</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">vegafusion</span> <span class="k">as</span> <span class="nn">vf</span>
<span class="kn">from</span> <span class="nn">vegafusion.connection.duckdb</span> <span class="kn">import</span> <span class="n">DuckDbConnection</span>
<span class="kn">import</span> <span class="nn">duckdb</span>

<span class="c1"># Create DuckDB connection</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># Wrap DuckDB connection in a VegaFusion DuckDbConnection instance</span>
<span class="c1"># with fallback=False and verbose=True</span>
<span class="n">vf</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">set_connection</span><span class="p">(</span><span class="n">DuckDbConnection</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Enable Mime Renderer</span>
<span class="n">vf</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="c1"># Read parquet file using the DuckDB connection</span>
<span class="n">relation</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s2">&quot;https://vegafusion-datasets.s3.amazonaws.com/vega/movies_201k.parquet&quot;</span>
<span class="p">)</span>

<span class="c1"># Filter NULL values and register the result as a table named &quot;movies&quot;</span>
<span class="n">relation</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;tbl&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM tbl </span>
<span class="s2">    WHERE Rotten_Tomatoes_Rating IS NOT NULL AND Imdb_Rating IS NOT NULL</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">(</span><span class="s2">&quot;movies&quot;</span><span class="p">)</span>

<span class="c1"># Create an Altair chart that references the registered DuckDB table</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="s2">&quot;table://movies&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mark_rect</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;IMDB_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">60</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;Rotten_Tomatoes_Rating:Q&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">40</span><span class="p">)),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;count():Q&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;greenblue&#39;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DuckDB</span> <span class="n">Query</span><span class="p">:</span>
<span class="n">WITH</span> <span class="n">movies_0</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="s2">&quot;movies&quot;</span><span class="p">),</span> <span class="n">movies_1</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">row_number</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">()</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">movies_0</span><span class="p">),</span> <span class="n">movies_2</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="n">AS</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="n">movies_1</span><span class="p">)</span> <span class="n">SELECT</span> <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;__min_val&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;__max_val&quot;</span> <span class="n">FROM</span> <span class="n">movies_2</span>

<span class="n">DuckDB</span> <span class="n">Query</span><span class="p">:</span>
<span class="n">WITH</span> <span class="n">movies_0</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="s2">&quot;movies&quot;</span><span class="p">),</span> <span class="n">movies_1</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">row_number</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">()</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">movies_0</span><span class="p">),</span> <span class="n">movies_2</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="n">AS</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="n">movies_1</span><span class="p">),</span> <span class="n">movies_3</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span><span class="p">,</span> <span class="n">FLOOR</span><span class="p">((((</span><span class="s2">&quot;IMDB_Rating&quot;</span> <span class="o">-</span> <span class="mf">1.6</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00000000000001</span><span class="p">))</span> <span class="n">AS</span> <span class="s2">&quot;__bin_index&quot;</span> <span class="n">FROM</span> <span class="n">movies_2</span><span class="p">),</span> <span class="n">movies_4</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;__bin_index&quot;</span><span class="p">,</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">WHEN</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="s2">&quot;IMDB_Rating&quot;</span> <span class="o">-</span> <span class="mf">9.4</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.00000000000001</span><span class="p">)</span> <span class="n">THEN</span> <span class="mf">9.200000000000001</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&gt;=</span> <span class="mi">39</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">ELSE</span> <span class="p">((</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.6</span><span class="p">)</span> <span class="n">END</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span> <span class="n">FROM</span> <span class="n">movies_3</span><span class="p">),</span> <span class="n">movies_5</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_4</span><span class="p">)</span> <span class="n">SELECT</span> <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;__min_val&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;__max_val&quot;</span> <span class="n">FROM</span> <span class="n">movies_5</span>

<span class="n">DuckDB</span> <span class="n">Query</span><span class="p">:</span>
<span class="n">WITH</span> <span class="n">movies_0</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="s2">&quot;movies&quot;</span><span class="p">),</span> <span class="n">movies_1</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">row_number</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">()</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">movies_0</span><span class="p">),</span> <span class="n">movies_2</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="n">AS</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span> <span class="n">AS</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">AS</span> <span class="s2">&quot;IMDB_Votes&quot;</span> <span class="n">FROM</span> <span class="n">movies_1</span><span class="p">),</span> <span class="n">movies_3</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span><span class="p">,</span> <span class="n">FLOOR</span><span class="p">((((</span><span class="s2">&quot;IMDB_Rating&quot;</span> <span class="o">-</span> <span class="mf">1.6</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00000000000001</span><span class="p">))</span> <span class="n">AS</span> <span class="s2">&quot;__bin_index&quot;</span> <span class="n">FROM</span> <span class="n">movies_2</span><span class="p">),</span> <span class="n">movies_4</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;__bin_index&quot;</span><span class="p">,</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">WHEN</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="s2">&quot;IMDB_Rating&quot;</span> <span class="o">-</span> <span class="mf">9.4</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.00000000000001</span><span class="p">)</span> <span class="n">THEN</span> <span class="mf">9.200000000000001</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&gt;=</span> <span class="mi">39</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">ELSE</span> <span class="p">((</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.6</span><span class="p">)</span> <span class="n">END</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span> <span class="n">FROM</span> <span class="n">movies_3</span><span class="p">),</span> <span class="n">movies_5</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_4</span><span class="p">),</span> <span class="n">movies_6</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span><span class="p">,</span> <span class="n">FLOOR</span><span class="p">((((</span><span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span> <span class="o">-</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.00000000000001</span><span class="p">))</span> <span class="n">AS</span> <span class="s2">&quot;__bin_index&quot;</span> <span class="n">FROM</span> <span class="n">movies_5</span><span class="p">),</span> <span class="n">movies_7</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;__bin_index&quot;</span><span class="p">,</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">WHEN</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span> <span class="o">-</span> <span class="mf">100.0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">0.00000000000001</span><span class="p">)</span> <span class="n">THEN</span> <span class="mf">95.0</span> <span class="n">WHEN</span> <span class="p">(</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">)</span> <span class="n">THEN</span> <span class="n">CAST</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span> <span class="n">AS</span> <span class="n">DOUBLE</span><span class="p">)</span> <span class="n">ELSE</span> <span class="p">((</span><span class="s2">&quot;__bin_index&quot;</span> <span class="o">*</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span><span class="p">)</span> <span class="n">END</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span> <span class="n">FROM</span> <span class="n">movies_6</span><span class="p">),</span> <span class="n">movies_8</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;US_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;Worldwide_Gross&quot;</span><span class="p">,</span> <span class="s2">&quot;US_DVD_Sales&quot;</span><span class="p">,</span> <span class="s2">&quot;Production_Budget&quot;</span><span class="p">,</span> <span class="s2">&quot;Release_Date&quot;</span><span class="p">,</span> <span class="s2">&quot;MPAA_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;Running_Time_min&quot;</span><span class="p">,</span> <span class="s2">&quot;Distributor&quot;</span><span class="p">,</span> <span class="s2">&quot;Source&quot;</span><span class="p">,</span> <span class="s2">&quot;Major_Genre&quot;</span><span class="p">,</span> <span class="s2">&quot;Creative_Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Director&quot;</span><span class="p">,</span> <span class="s2">&quot;Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;IMDB_Votes&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span> <span class="o">+</span> <span class="mf">5.0</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_7</span><span class="p">),</span> <span class="n">movies_9</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;__count&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;_vf_order&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_8</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">),</span> <span class="n">movies_10</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;__count&quot;</span> <span class="n">FROM</span> <span class="n">movies_9</span><span class="p">),</span> <span class="n">movies_11</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">movies_10</span> <span class="n">WHERE</span> <span class="n">coalesce</span><span class="p">((((</span><span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span> <span class="n">AND</span> <span class="n">isfinite</span><span class="p">(</span><span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">))</span> <span class="n">AND</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span><span class="p">)</span> <span class="n">AND</span> <span class="n">isfinite</span><span class="p">(</span><span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">)),</span> <span class="n">false</span><span class="p">)),</span> <span class="n">movies_12</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;__count&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_11</span><span class="p">),</span> <span class="n">movies_13</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">movies_12</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">ASC</span> <span class="n">NULLS</span> <span class="n">LAST</span><span class="p">)</span> <span class="n">SELECT</span> <span class="s2">&quot;__count&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">movies_13</span>

<span class="n">DuckDB</span> <span class="n">Query</span><span class="p">:</span>
<span class="n">WITH</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_0</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;__count&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="s2">&quot;arrow_d1f7607d_83e8_4826_a706_b57d6a475687&quot;</span><span class="p">),</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_1</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;__count&quot;</span> <span class="n">AS</span> <span class="s2">&quot;__count&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_40_Rotten_Tomatoes_Rating_end&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating&quot;</span><span class="p">,</span> <span class="s2">&quot;bin_maxbins_60_IMDB_Rating_end&quot;</span> <span class="n">FROM</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_0</span><span class="p">),</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_2</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;__count&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="s2">&quot;__count&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="s2">&quot;_vf_order&quot;</span><span class="p">)</span> <span class="n">AS</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">FROM</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_1</span><span class="p">),</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_3</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="s2">&quot;_vf_order&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span> <span class="n">FROM</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_2</span><span class="p">),</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_4</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_3</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="s2">&quot;_vf_order&quot;</span> <span class="n">ASC</span> <span class="n">NULLS</span> <span class="n">LAST</span><span class="p">)</span> <span class="n">SELECT</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span> <span class="n">FROM</span> <span class="n">arrow_d1f7607d_83e8_4826_a706_b57d6a475687_4</span>
</pre></div>
</div>
<p><img alt="2D Histogram Heatmap" src="https://user-images.githubusercontent.com/15064365/226609213-2eba5e0b-1377-47d1-9ca9-32dc8f43fb8c.png" /></p>
<p>The four DuckDB queries required to render this chart are displayed above.</p>
</section>
</section>
</section>

<div class="section ablog__blog_comments">
  
  
</div>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="integrations.html" class="btn btn-neutral float-left" title="Integrations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="polars.html" class="btn btn-neutral float-right" title="Polars" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jon Mease.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LVD2GWXRQZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-LVD2GWXRQZ', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>